- def groupSuffixLevel1=[catalogs, templates, medialibrary, cloudmanager]
- def groupList=[reader, contributor, entity-manager, project-manager]


- group_config:
    - mediahub-basic:
        - name:
          isMemberOf: everyone
          members:
          path: /home/groups/mediahub
    - mediahub-basic-contributor:
        - name:
          isMemberOf:
          members:
          path: /home/groups/mediahub
    - mediahub-administrator:
        - name:
          isMemberOf: administrators
          members:
          path: /home/groups/mediahub
    - mediahub-basic-reader:
        - name:
          isMemberOf:
          members:
          path: /home/groups/mediahub
    - mediahub-basic-entity-manager:
        - name:
          isMemberOf: projects-administrators,user-administrators
          members:
          path: /home/groups/mediahub
    - mediahub-basic-project-manager:
        - name:
          isMemberOf: projects-administrators
          members:
          path: /home/groups/mediahub
    - mediahub-reader-medialibrary:
        - name: Mediahub - Reader Medialibrary
          isMemberOf: mediahub-basic
          members:
          path: /home/groups/mediahub
    - FOR group IN ${groupList}:
        - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement:
            - group_functions-company_engagement-${entity.name}-${group}:
               - name: Mediahub - Group functions - Company Engagement - ${entity.title} - ${group}
                 isMemberOf: mediahub-basic, mediahub-basic-${group} 
                 path: /home/groups/mediahub/medialibrary/group_functions/company_engagement/${entity.title}

    - FOR group IN ${groupList}:
        - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement/group_communications:
            - group_functions-company_engagement-group_communications-${entity.name}-${group}:
               - name: Mediahub - Group functions - Company Engagement - Group Communications - ${entity.title} - ${group}
                 isMemberOf: mediahub-basic, mediahub-basic-${group}  
                 path: /home/groups/mediahub/medialibrary/group_functions/company_engagement/group_communications/${entity.title}
    - FOR group IN ${groupList}:           
        - FOR entity IN CHILDREN OF /content/dam/medialibrary:
            - ${entity.name}-${group}:
               - name: Mediahub - ${entity.title} - ${group}
                 isMemberOf: mediahub-basic, mediahub-basic-${group}  
                 path: /home/groups/mediahub/medialibrary/${entity.name}

            - FOR subentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}:
               - ${entity.name}-${subentity.name}-${group}:
                   - name: Mediahub - ${entity.title} - ${subentity.title} - ${group}
                     isMemberOf: mediahub-basic, mediahub-basic-${group}  
                     path: /home/groups/mediahub/medialibrary/${entity.name}/${subentity.name}

                   - FOR subsubentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}/${subentity.name}:
                       - ${entity.name}-${subentity.name}-${subsubentity.name}-${group}:
                            - name: Mediahub - ${entity.title} - ${subentity.title} - ${subsubentity.title} - ${group}
                              isMemberOf: mediahub-basic, mediahub-basic-${group}  
                              path: /home/groups/mediahub/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}

- ace_config:
  #DEFAULT GROUP 
    - mediahub-basic:
        - path: /
          permission: allow
          actions: read
        - path: /content/dam
          permission: deny
          actions: modify,create,delete,acl_read,acl_edit,replicate
        - path: /content/dam
          permission: allow
          actions: read
        - path: /content/projects
          permission: deny
          actions: modify,create,delete,acl_read,acl_edit,replicate
        - path: /content/projects
          permission: allow
          actions: read
        - path: /content/dam/projects
          permission: deny
          actions: modify,create,delete,acl_read,acl_edit,replicate
        - path: /content/dam/projects
          permission: allow
          actions: read
        - path: /libs/cq/core/content/projects/templates/default
          permission: deny
          actions: read
        - path: /libs/cq/core/content/projects/templates/translation-project
          permission: deny
          actions: read
        - path: /libs/cq/core/content/projects/templates/creative-project-management
          permission: deny
          actions: read
        - path: /libs/cq/core/content/projects/templates/retail-product-photoshoot
          permission: deny
          actions: read
          
        - FOR path IN ${groupSuffixLevel1}:
            - path: /content/dam
              permission: deny
              privileges: jcr:all
              keepOrder: true
              restrictions:
                rep:glob: '/${path}'
        - FOR path IN CHILDREN OF /content/dam/medialibrary:
            - path: /content/dam/medialibrary/${path.name}
              permission: deny
              privileges: jcr:all
            - path: /content/dam/projects/${path.name}
              permission: deny
              privileges: jcr:all
            - path: /content/projects/${path.name}
              permission: deny
              privileges: jcr:all
            - FOR subpath IN CHILDREN OF /content/dam/medialibrary/${path.name}:
                - path: /content/dam/medialibrary/${path.name}/${subpath.name}
                  permission: deny
                  privileges: jcr:all
                - path: /content/dam/projects/${path.name}/${subpath.name}
                  permission: deny
                  privileges: jcr:all
                - path: /content/projects/${path.name}/${subpath.name}
                  permission: deny
                  privileges: jcr:all
                - FOR subsubpath IN CHILDREN OF /content/dam/medialibrary/${path.name}/${subpath.name}:
                    - path: /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}
                      permission: deny
                      privileges: jcr:all
                    - path: /content/dam/projects/${path.name}/${subpath.name}/${subsubpath.name}
                      permission: deny
                      privileges: jcr:all
                    - path: /content/projects/${path.name}/${subpath.name}/${subsubpath.name}
                      permission: deny
                      privileges: jcr:all
                    - FOR subsubsubpath IN CHILDREN OF /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}:
                        - path: /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}/${subsubsubpath.name}
                          permission: deny
                          privileges: jcr:all
                        - path: /content/dam/projects/${path.name}/${subpath.name}/${subsubpath.name}/${subsubsubpath.name}
                          permission: deny
                          privileges: jcr:all                          
                        - path: /content/projects/${path.name}/${subpath.name}/${subsubpath.name}/${subsubsubpath.name}
                          permission: deny
                          privileges: jcr:all

        - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/user_experience/vst/dms/mediahub/
          permission: allow
          actions: read
        - path: /conf
          permission: allow
          actions: read
        - path: /etc
          permission: allow
          actions: read
        - path: /var
          permission: allow
          actions: read
        - path: /libs/wcm/core/content/sites
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/sites
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/experiencefragments
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/experience-fragments/content/experience-fragments
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/commerce
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/forms
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/communities
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/screens
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/screens/dcc/content/main
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/dam/gui/content/idsprint/templates
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/assets/templates
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/cq/core/content/nav/assets/catalogs
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /libs/dam/gui/content/idsprint/catalogs
          permission: deny
          actions: read,modify,create,delete,acl_read,acl_edit,replicate
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/creator
          permission: deny
          actions: read
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/filesize
          permission: deny
          actions: read
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/description
          permission: deny
          actions: read
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/notes
          permission: deny
          actions: read
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/keywords
          permission: deny
          actions: read
        - path: /conf/global/settings/dam/search/facets/assets/jcr:content/items/tags
          permission: deny
          actions: read          
    - mediahub-basic-reader:
        - path: /libs/dam/gui/content/assets/managetags/jcr:content/body/items/form/items/wizard/items/moderateStep/items/actionbar/primary/promote
          permission: deny
          actions: read
        - path: /libs/granite/ui/content/shell/globalnav/cq/items/tabs/items/tools
          permission: deny
          actions: read
        - path: /libs/wcm/core/content/misc
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'
        - path: /apps/cq/core/content/nav/tools
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'

    - mediahub-basic-contributor:
        - path: /libs/dam/gui/content/assets/managetags/jcr:content/body/items/form/items/wizard/items/moderateStep/items/actionbar/primary/promote
          permission: deny
          actions: read
        - path: /content/cq:tags/default
          permission: allow
          actions: create,modify
        - path: /var/workflow/models
          permission: deny
          actions: read
          restrictions:
             rep:glob: '/*'
        - path: /libs/granite/ui/content/shell/globalnav/cq/items/tabs/items/tools
          permission: deny
          actions: read
        - path: /libs/wcm/core/content/misc
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'
        - path: /apps/cq/core/content/nav/tools
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'
    - mediahub-basic-project-manager:
        - path: /var/workflow/models
          permission: deny
          actions: read
          restrictions:
             rep:glob: '/*'
        - path: /libs/granite/ui/content/shell/globalnav/cq/items/tabs/items/tools
          permission: deny
          actions: read
        - path: /libs/wcm/core/content/misc
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'
        - path: /apps/cq/core/content/nav/tools
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'

    - mediahub-basic-entity-manager:
        - path: /home/groups
          permission: deny
          privileges: jcr:read

        - path: /content/cq:tags/default
          permission: allow
          actions: create,modify
        - path: /var/workflow/models
          permission: deny
          actions: read
          restrictions:
             rep:glob: '/mediahub/contributor/*'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/cloudservices'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/deployment'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/resources'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/assets'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/sites'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/operations'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/cloudservices'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/communities'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/general'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/workflow'
        - path: /libs/cq/core/content/nav/tools 
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/commerce'
        - path: /libs/cq/core/content/nav/tools/security/oauth
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools/security/oauthtokens
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools/security/sslConfig
          permission: deny
          actions: read
        - path: /libs/cq/core/content/nav/tools/security/truststore
          permission: deny
          actions: read
        - path: /apps/cq/core/content/nav/tools
          permission: deny
          actions: read
          restrictions:
              rep:glob: '/*'


    # GROUP READER SETUP PERMISSION
    - mediahub-reader-medialibrary:
        - path: /content/dam/medialibrary
          permission: allow
          privileges: jcr:read
        - FOR path IN CHILDREN OF /content/dam/medialibrary:
            - path: /content/dam/medialibrary/${path.name}
              permission: allow
              privileges: jcr:read
            - FOR subpath IN CHILDREN OF /content/dam/medialibrary/${path.name}:
                - path: /content/dam/medialibrary/${path.name}/${subpath.name}
                  permission: allow
                  privileges: jcr:read
                - FOR subsubpath IN CHILDREN OF /content/dam/medialibrary/${path.name}/${subpath.name}:
                    - path: /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}
                      permission: allow
                      privileges: jcr:read
                    - FOR subsubsubpath IN CHILDREN OF /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}:
                        - path: /content/dam/medialibrary/${path.name}/${subpath.name}/${subsubpath.name}/${subsubsubpath.name}
                          permission: allow
                          privileges: jcr:read

    #Specific group_functions/company_engagement  
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement:
        - group_functions-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read
        - group_functions-company_engagement-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read
        - group_functions-company_engagement-${entity.name}-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
     #Specific group_functions/company_engagement/group_communications 
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement/group_communications:
        - group_functions-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read
        - group_functions-company_engagement-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read
        - group_functions-company_engagement-group_communications-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read
        - group_functions-company_engagement-group_communications-${entity.name}-reader:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
     #Generic cases
    - FOR entity IN CHILDREN OF /content/dam/medialibrary:
        - ${entity.name}-reader:
           - path: /content/dam/medialibrary/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
        - FOR subentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}:
           - ${entity.name}-reader:
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read
           - ${entity.name}-${subentity.name}-reader:
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/medialibrary/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam
                 permission: allow
                 privileges: jcr:read
                 restrictions:
                   rep:glob: '/medialibrary'
           - FOR subsubentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}/${subentity.name}:
               - ${entity.name}-reader:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
               - ${entity.name}-${subentity.name}-reader:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
               - ${entity.name}-${subentity.name}-${subsubentity.name}-reader:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam
                     permission: allow
                     privileges: jcr:read
                     restrictions:
                       rep:glob: '/medialibrary'

    # GROUP CONTRIBUTOR SETUP PERMISSION

    #Specific group_functions/company_engagement  
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement:
        - group_functions-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read,modify,create,delete
        - group_functions-company_engagement-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read,modify,create,delete
        - group_functions-company_engagement-${entity.name}-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read,modify,create,delete
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
    #Specific group_functions/company_engagement/group_communications 
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement/group_communications:
        - group_functions-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read,modify,create,delete
        - group_functions-company_engagement-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read,modify,create,delete
        - group_functions-company_engagement-group_communications-${entity.name}-contributor:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             actions: read,modify,create,delete
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'    
    #Generic cases
    - FOR entity IN CHILDREN OF /content/dam/medialibrary:
        - ${entity.name}-contributor:
           - path: /content/dam/medialibrary/${entity.name}
             permission: allow
             actions: read,modify,create,delete
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
        - FOR subentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}:
           - ${entity.name}-contributor:
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read,modify,create,delete
           - ${entity.name}-${subentity.name}-contributor:
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read,modify,create,delete
               - path: /content/dam/medialibrary/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam
                 permission: allow
                 privileges: jcr:read
                 restrictions:
                   rep:glob: '/medialibrary'
           - FOR subsubentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}/${subentity.name}:
               - ${entity.name}-contributor:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read,modify,create,delete
               - ${entity.name}-${subentity.name}-contributor: 
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read,modify,create,delete
               - ${entity.name}-${subentity.name}-${subsubentity.name}-contributor:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read,modify,create,delete
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam
                     permission: allow
                     privileges: jcr:read
                     restrictions:
                       rep:glob: '/medialibrary'      

 # GROUP ENTITY-MANAGER SETUP PERMISSION

    #Specific group_functions/company_engagement  
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement:
        - group_functions-entity-manager:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-entity-manager:
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-${entity.name}-entity-manager:
           - path: /home/groups/mediahub/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/projects/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/projects/medialibrary/group_functions
             permission: allow
             actions: read

    #Specific group_functions/company_engagement/group_communications 
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement/group_communications:
        - group_functions-entity-manager:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-entity-manager:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-group_communications-entity-manager:
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-group_communications-${entity.name}-entity-manager:
           - path: /home/groups/mediahub/medialibrary/group_functions/company_engagement/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/medialibrary/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/projects/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/projects/group_functions
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions
             permission: allow
             actions: read    
    #Generic cases
    - FOR entity IN CHILDREN OF /content/dam/medialibrary:
        - ${entity.name}-entity-manager:
           - path: /home/groups/mediahub/medialibrary/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam/medialibrary/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'
           - path: /content/projects/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/${entity.name}
             permission: allow
             privileges: jcr:all
        - FOR subentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}:
           - ${entity.name}-entity-manager:
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
           - ${entity.name}-${subentity.name}-entity-manager:
               - path: /home/groups/mediahub/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/medialibrary/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam
                 permission: allow
                 privileges: jcr:read
                 restrictions:
                   rep:glob: '/medialibrary'
               - path: /content/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/projects/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/projects/${entity.name}
                 permission: allow
                 actions: read
           - FOR subsubentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}/${subentity.name}:
               - ${entity.name}-entity-manager:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
               - ${entity.name}-${subentity.name}-entity-manager:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
               - ${entity.name}-${subentity.name}-${subsubentity.name}-entity-manager:
                   - path: /home/groups/mediahub/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam
                     permission: allow
                     privileges: jcr:read
                     restrictions:
                       rep:glob: '/medialibrary'
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/projects/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/projects/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/projects/${entity.name}
                     permission: allow
                     actions: read   

 # GROUP PROJECT-MANAGER SETUP PERMISSION

    #Specific group_functions/company_engagement  
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement:
        - group_functions-project-manager:
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-project-manager:
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-${entity.name}-project-manager:
           - path: /content/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/projects/medialibrary/group_functions
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/medialibrary/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/projects/medialibrary/group_functions
             permission: allow
             actions: read

    #Specific group_functions/company_engagement/group_communications 
    - FOR entity IN CHILDREN OF /content/dam/medialibrary/group_functions/company_engagement/group_communications:
        - group_functions-project-manager:
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-project-manager:
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-group_communications-project-manager:
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
        - group_functions-company_engagement-group_communications-${entity.name}-project-manager:
           - path: /content/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/projects/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/projects/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/projects/group_functions
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement/group_communications/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/group_functions/company_engagement/group_communications
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions/company_engagement
             permission: allow
             actions: read
           - path: /content/dam/projects/group_functions
             permission: allow
             actions: read
        
    #Generic cases
    - FOR entity IN CHILDREN OF /content/dam/medialibrary:
        - ${entity.name}-project-manager:
           - path: /content/projects/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/projects/${entity.name}
             permission: allow
             privileges: jcr:all
           - path: /content/dam/medialibrary/${entity.name}
             permission: allow
             actions: read
           - path: /content/dam
             permission: allow
             privileges: jcr:read
             restrictions:
               rep:glob: '/medialibrary'

        - FOR subentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}:
           - ${entity.name}-project-manager:
               - path: /content/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read                             
           - ${entity.name}-${subentity.name}-project-manager:
               - path: /content/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/projects/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/projects/${entity.name}/${subentity.name}
                 permission: allow
                 privileges: jcr:all
               - path: /content/dam/projects/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                 permission: allow
                 actions: read
               - path: /content/dam/medialibrary/${entity.name}
                 permission: allow
                 actions: read
               - path: /content/dam
                 permission: allow
                 privileges: jcr:read
                 restrictions:
                   rep:glob: '/medialibrary'

           - FOR subsubentity IN CHILDREN OF /content/dam/medialibrary/${entity.name}/${subentity.name}:
               - ${entity.name}-project-manager:
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read 
               - ${entity.name}-${subentity.name}-project-manager:
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all 
               - ${entity.name}-${subentity.name}-${subsubentity.name}-project-manager:
                   - path: /content/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/projects/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/projects/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/projects/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     privileges: jcr:all
                   - path: /content/dam/projects/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/projects/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}/${subsubentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}/${subentity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam/medialibrary/${entity.name}
                     permission: allow
                     actions: read
                   - path: /content/dam
                     permission: allow
                     privileges: jcr:read
                     restrictions:
                       rep:glob: '/medialibrary'